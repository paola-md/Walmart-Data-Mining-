sideMenuKPI <- function(idDash,idTS,idTop) {
  # Create a namespace function using the provided id
  tagList(
    menuItem("Análisis Univariado", tabName = "kpisNav",
             icon= icon("stats",
                                                          lib="glyphicon")),
    conditionalPanel("input.sidebarMenu == 'kpisNav' & input.kpisTabset == 'TSDash'",
                     selectizeInput(paste0(idTS,"cat"),
                                    label="Variable Categórica a visualizar:",
                                    choices=categoricas,
                                    selected=categoricas[1])),
    conditionalPanel("input.sidebarMenu == 'kpisNav' & input.kpisTabset == 'TS1Dash2'",
                     selectizeInput(paste0(idTS,"num"),
                                    label="Variable numérica a visualizar:",
                                    choices=categoricas,
                                    selected=categoricas[1])),
    menuItem("Análisis Bivariado", tabName = "kpisNav2",
             icon= icon("stats",
                        lib="glyphicon")),
    conditionalPanel("input.sidebarMenu == 'kpisNav2' & input.kpisTabset2 == 'TS2Dash'",
                     selectizeInput(paste0(idTS,"cat1"),
                                    label="Primer variable categórica a visualizar:",
                                    choices=categoricas,
                                    selected=categoricas[1]),
                      selectizeInput(paste0(idTS,"cat2"),
                                     label="Segunda variable categórica a visualizar:",
                                     choices=categoricas,
                                     selected=categoricas[2])),
    menuItem("Análisis Multivariado", tabName = "kpisNav3",
             icon= icon("stats",
                        lib="glyphicon")),
    conditionalPanel("input.sidebarMenu == 'kpisNav3' & input.kpisTabset3 == 'TS3Dash'",
                     selectizeInput(paste0(idTS,"heat1"),
                                    label="Categorías a clusterizar:",
                                    choices=mixtas,
                                    selected='producto_departamento'),
                     selectizeInput(paste0(idTS,"heat2"),
                                    label="Variable de agrupamiento:",
                                    choices=mixtas,
                                    selected='visita_tipo'),
                     selectizeInput(paste0(idTS,"heat3"),
                                    label="Variable para conteos:",
                                    choices=conteo,
                                    selected=conteo[1]),
               sliderInput2(paste0(idTS,"heat4"),
                                 "Umbral de métrica de asociación:",
                            min = 0, max = 1, value = .8, step = .05, 
                            from_min = .5, from_max = 1)),
    conditionalPanel("input.sidebarMenu == 'kpisNav3' & input.kpisTabset3 == 'TS3Dash2'",
                     selectizeInput(paste0(idTS,"gra1"),
                                    label="Categorías a clusterizar:",
                                    choices=mixtas,
                                    selected='producto_departamento'),
                     selectizeInput(paste0(idTS,"gra2"),
                                    label="Variable de agrupamiento:",
                                    choices=mixtas,
                                    selected='visita_tipo'),
                     selectizeInput(paste0(idTS,"gra3"),
                                    label="Variable para conteos:",
                                    choices=conteo,
                                    selected=conteo[1]),
                     sliderInput2(paste0(idTS,"gra4"),
                                  "Umbral de métrica de asociación:",
                                  min = 0, max = 1, value = .8, step = .05, 
                                  from_min = .5, from_max = 1)),
    conditionalPanel("input.sidebarMenu == 'kpisNav3' & input.kpisTabset3 == 'TS3Dash3'",
                     selectizeInput(paste0(idTS,"ph1"),
                                    label="Categorías a clusterizar:",
                                    choices=mixtas,
                                    selected='producto_departamento'),
                     selectizeInput(paste0(idTS,"ph2"),
                                    label="Variable de agrupamiento:",
                                    choices=mixtas,
                                    selected='visita_tipo'),
                     selectizeInput(paste0(idTS,"ph3"),
                                    label="Variable para conteos:",
                                    choices=conteo,
                                    selected=conteo[1]),
                     sliderInput2(paste0(idTS,"ph4"),
                                  "Umbral de métrica de asociación:",
                                  min = 0, max = 1, value = .8, step = .05, 
                                  from_min = .5, from_max = 1))
    
  
  )
}
